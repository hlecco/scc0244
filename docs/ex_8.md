## Exercício 8

O exercício 8 é facilitado por já termos disponível a view criada no
exercício 2 classificando os resultados de Covid.

Assim, basta fazer:

``` sql
SELECT id_paciente,
       id_atendimento,
       de_resultado AS de_resultado_bruto,
       de_valor_referencia,
       (CASE WHEN resultado = TRUE THEN 'Positivo' WHEN resultado = FALSE THEN 'Negativo' ELSE NULL END) AS de_resultado
FROM dados_processados.exames e
INNER JOIN dados_processados.exames_covid_resultado ecr
ON e.id_exame = ecr.id_exame
```

id_paciente                         |id_atendimento                      |de_resultado_bruto                                                                                                                                                                                                                                             |de_valor_referencia|de_resultado|
------------------------------------|------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------|------------|
00000000-0000-0000-18a7-b01b525141be|2f41ccfb-7357-85e1-0c1a-39a3331c6c0d|0,1                                                                                                                                                                                                                                                            |UA/mL              |            |
00000000-0000-0000-6700-b7e0f0886221|3c39d4d3-9db5-09ee-0389-eab7b1c4e7af|NAO DETECTADO (NEGATIVO)                                                                                                                                                                                                                                       |                   |Negativo    |
00000000-0000-0000-c84e-2acf3c213af7|5cef0a53-83ee-9af9-db4e-7cc7d97a0dcf|NAO DETECTADO (NEGATIVO)                                                                                                                                                                                                                                       |                   |Negativo    |
00000000-0000-0000-6172-d405e775647c|64b39581-9fdb-bd1e-f866-e9f1dacd9aba|Amostra NAO REAGENTE para anticorpos contra SARS-CoV-2,                                                                                                                                                                                                        |                   |Negativo    |
00000000-0000-0000-18cd-40498eac3e42|65631672-a0ff-c2b7-1c6d-d1469a1ed17a|0,1                                                                                                                                                                                                                                                            |UA/mL              |            |
00000000-0000-0000-85cb-215a3a0da962|6b62e35e-6e20-90a9-2e99-4505711faeb4|REAGENTE                                                                                                                                                                                                                                                       |                   |Positivo    |
00000000-0000-0000-b7f2-96bc7c3c2bb7|8ddd7fbd-c2d8-6637-874f-0acb38d36306|NAO REAGENTE                                                                                                                                                                                                                                                   |                   |Negativo    |
00000000-0000-0000-7959-a6a1e5a4d0af|90f1cd9c-b0b9-c8a8-ad5e-faaded7963b0|29,2                                                                                                                                                                                                                                                           |                   |            |
00000000-0000-0000-402d-c20a10497ec9|a139fbbb-b50d-8b30-cf0b-689dc59c0062|0,7                                                                                                                                                                                                                                                            |UA/mL              |            |
00000000-0000-0000-fade-e14ae5b78c1f|ab53c593-9bcf-defd-bac0-e1c2c5c1f865|NAO REAGENTE                                                                                                                                                                                                                                                   |                   |Negativo    |
00000000-0000-0000-6068-3fcae322aeb9|ce613c02-9959-02de-c072-65a730803906|NAO REAGENTE                                                                                                                                                                                                                                                   |                   |Negativo    |
00000000-0000-0000-9047-011567508461|fef0eff7-d890-180e-bf96-30d819471726|REAGENTE                                                                                                                                                                                                                                                       |                   |Positivo    |
39cc3b46-d1ab-57a8-05e7-7a980a0e72af|010cd802-a294-5f60-e96b-92665dfbd2e2|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
fab17add-9067-0529-fadb-967bae1fdd0f|03b9dd36-6133-2531-da0b-8803e4a67e0c|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
61082d02-5e4a-d5a7-376a-c2ae8ddc41fd|0e5cbc72-1a55-cc38-1893-663dd3a5bf04|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
5609e626-a46a-7c45-5210-18861c338b3a|108f493b-3fff-bc8e-ea10-c098543b6cbd|Detectado                                                                                                                                                                                                                                                      |Não detectado      |Positivo    |
58696003-f5f2-421b-e018-19cfabb01d2e|15d3a97f-1cd9-c6ff-317e-a551aba084e9|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
3b120a13-5720-6f25-f60e-979e77f6893a|16947874-26f2-d838-9dae-a7ef21d3a582|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
179ef60d-91f5-0412-59af-4235de67ffaa|1922da5e-6ae4-b3af-8a07-41ecf7ff2bd4|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
020656d7-4d0e-d01d-e959-d2aec7d7ece5|19583bd3-4344-a69e-338c-0a681909816b|0.07                                                                                                                                                                                                                                                           |<=0.90             |Negativo    |
41f24a84-bdbf-8c9e-4f3a-92ddcc3dc102|19828111-f626-b7cd-9011-99ca5d093833|Não reagente                                                                                                                                                                                                                                                   |                   |Negativo    |
330960f6-228c-b90c-2e64-554f2306313f|1a75d5b0-66c7-2ca8-702a-0f5f750ca808|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
2bc26224-4c8c-d7ad-61ac-3bc66e147ca5|233a60b8-d9f1-0d11-13ca-91555f478228|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
bf13ca4e-c713-e6a1-7ff2-9e8aeb5a30b6|2591e6f6-802f-acdb-8433-bb78982d0b96|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
55854d03-52cc-858e-b8bf-03a7c817d7a8|2ded210e-48df-d065-756d-1f3470bf6172|Não reagente                                                                                                                                                                                                                                                   |                   |Negativo    |
b9035e13-51b2-fbc8-e28e-d602311406a7|2f5c9f02-e63e-200a-5b10-41659f4a9c10|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
4f98bbbd-4473-5808-ead9-32dee7c46ba8|31fa2a50-61df-1a5b-e157-3b08a22d0b93|Detectado                                                                                                                                                                                                                                                      |Não detectado      |Positivo    |
bb2fa385-dbe9-7391-21fb-e0d445cda0a6|38d020d6-bbbf-cd8b-e92d-0ef9f4eea5f9|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
231c01e7-5c14-aab8-10e4-10e44ed065d8|38d09d11-0d46-d8bc-23b7-4b5f2ec09208|0.03                                                                                                                                                                                                                                                           |<=0.90             |Negativo    |
c9bab5b1-dfb0-d98f-f1f9-de121571ceee|38d0f12e-4642-8e15-64cd-b291d9a70924|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
89294670-d008-f2f7-284c-6b14168a7155|39149704-df1a-05fb-19d0-a1628deb4207|Não detectado                                                                                                                                                                                                                                                  |Não detectado      |Negativo    |
89a23ad0-9239-a487-d2b3-6dbaa32d54e5|41382385-5c5d-28c8-2906-50151020ff3d|Detectado                                                                                                                                                                                                                                                      |Não detectado      |Positivo    |

A alteração não foi executada para permitir que os scripts anteriores sejam executados sem falhas
